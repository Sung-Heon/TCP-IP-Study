# 인터넷 주소 체계

전송되는 데이터의 목적지 주소는 IP 주소와 Port 번호로 이루어진다. 

IP 주소 : 인터넷 상에서 데이터의 송수신을 목적으로 컴퓨터에 부여하는 값

Port 번호 : 프로그램 상에서 생성되는 소켓을 구분하기 위해 소켓에 부여되는 번호

### IP 주소

- 주소 체계(Address Family)에는 IPv4(4 바이트)와 IPv6(16 바이트)가 있다.
- IP는 컴퓨터 하드웨어인 NIC(Network Interface Card)라는 장치를 통해 컴퓨터 내부로 전송하는데 사용된다.
- IP 주소는 네트워크 ID와 호스트 ID로 이루어진다.
    - 데이터가 전송될 때, 처음부터 IP 주소의 전체 바이트를 참고하는 것이 아니라, 네트워크 주소만을 참고해서 일단 목적지 네트워크로 데이터를 보낸다. 그 다음 해당 네트워크를 구성하는 라우터가 IP 주소의 호스트 ID를 참조해서 목적지 컴퓨터로 데이터를 전송해준다.

### Port 번호

- 컴퓨터 내부로 전송된 데이터의 처리는 OS가 담당하는데, 이 때 Port 번호를 사용해서 일치하는 번호의 소켓에 데이터를 전달한다.
- 동일한 전송 방식을 사용하는 소켓의 Port 번호는 중복될 수 없다.
    - TCP 소켓과 UDP 소켓의 Port 번호는 중복되어도 상관없다.

<br />

# 네트워크 바이트 순서

### 데이터 저장 순서

CPU가 데이터를 메모리에 저장하는 방식은 다음과 같이 두 가지로 나뉜다. 

- 빅 엔디안(Big Endian) : 상위 바이트의 값을 작은 번지수에 저장하는 방식 (데이터를 순서대로 저장)
    - ex) 0x12345678 → 0x12 / 0x34 / 0x56 / 0x78 (낮은 주소 → 높은 주소)
- 리틀 엔디안(Little Endian) : 상위 바이트의 값을 큰 번지수에 저장하는 방식 (데이터를 역순으로 저장)
    
     ex) 0x12345678 → 0x78 / 0x56 / 0x34 / 0x12 (낮은 주소 → 높은 주소)
    

### 호스트 바이트 순서와 네트워크 바이트 순서

- CPU가 데이터를 저장하는 방식인 **호스트 바이트 순서**는 CPU에 따라 차이가 난다.
    - 인텔과 AMD 계열은 리틀 엔디안 방식을 사용한다.
- 그런데 호스트 바이트 순서가 각기 다른 컴퓨터에 데이터를 전송하는 경우, 전송된 값의 해석이 달라져버리는 문제가 발생한다.
- 그래서 네트워크를 통해서 데이터를 전송할 때는 **빅 엔디안 방식**으로 통일하자는 게 **네트워크 바이트 순서**이다.
- 따라서 리틀 엔디안 시스템에서는 데이터를 전송하기에 앞서 빅 엔디안 방식으로 데이터를 재정렬하는 작업이 필요하다. OS에서는 이러한 바이트 변환을 돕는 함수를 제공한다.
    - `htons()` / `htonl()` / `ntohs()` / `ntohl()`
    - h : host / n : network / s : short(2 바이트) / l : long(4 바이트)
    - 소켓의 주소값 이외의 데이터는 송수신 과정에서 자동으로 이루어진다.
   
